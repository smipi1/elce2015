
CONFIG_NET_SMALL flow cache hash sizing


 tiny-mpm/net/core/flow.c |    4 ++++
 1 files changed, 4 insertions(+)

Index: linux-2.6.23-rc9/net/core/flow.c
===================================================================
--- linux-2.6.23-rc9.orig/net/core/flow.c	2007-10-08 23:51:25.000000000 +0200
+++ linux-2.6.23-rc9/net/core/flow.c	2007-10-08 23:52:27.000000000 +0200
@@ -351,7 +351,11 @@
 					sizeof(struct flow_cache_entry),
 					0, SLAB_HWCACHE_ALIGN|SLAB_PANIC,
 					NULL);
+#ifdef CONFIG_NET_SMALL
+ 	flow_hash_shift = 3;
+#else
 	flow_hash_shift = 10;
+#endif
 	flow_lwm = 2 * flow_hash_size;
 	flow_hwm = 4 * flow_hash_size;
 
