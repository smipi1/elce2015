
configurable number of supported IDE interfaces


 include/linux/ide.h |    5 	5 +	0 -	0 !
 init/Kconfig        |    9 	9 +	0 -	0 !
 2 files changed, 14 insertions(+)

Index: linux-2.6.23-rc9/include/linux/ide.h
===================================================================
--- linux-2.6.23-rc9.orig/include/linux/ide.h	2007-10-08 23:51:25.000000000 +0200
+++ linux-2.6.23-rc9/include/linux/ide.h	2007-10-09 00:29:04.000000000 +0200
@@ -304,6 +304,11 @@
 }
 #endif /* IDE_ARCH_OBSOLETE_INIT */
 
+#if defined(CONFIG_IDE_HWIFS) && CONFIG_IDE_HWIFS > 0
+#undef MAX_HWIFS
+#define MAX_HWIFS CONFIG_IDE_HWIFS
+#endif
+
 /* Currently only m68k, apus and m8xx need it */
 #ifndef IDE_ARCH_ACK_INTR
 # define ide_ack_intr(hwif) (1)
Index: linux-2.6.23-rc9/init/Kconfig
===================================================================
--- linux-2.6.23-rc9.orig/init/Kconfig	2007-10-09 00:29:04.000000000 +0200
+++ linux-2.6.23-rc9/init/Kconfig	2007-10-09 00:29:37.000000000 +0200
@@ -759,6 +759,15 @@
 	help
 	  This option allows reducing the size of the O(1) scheduler arrays.
 
+config IDE_HWIFS
+	depends IDE
+	int "Number of IDE hardware interfaces (0 for default)" if EMBEDDED
+	range 0 20
+	default 0
+	help
+	  Select the maximum number of IDE interfaces (0 for default).
+          Saves up to 14k.
+
 endmenu		# General setup
 
 config RT_MUTEXES
